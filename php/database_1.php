<?php
include('connect_PRINC18.php');

$echelle = $_POST["echelle"];
$annee = $_POST["annee"];

if($echelle == "Communes"){

$table="btx_td_princ18_".$annee;

if(isset($_POST["requete"])){

$requetePRINC18 = "SELECT codgeo, CS1_81_TYPLR1_VOIT0 + CS1_82_TYPLR1_VOIT0 + CS1_83_TYPLR1_VOIT0 + CS1_84_TYPLR1_VOIT0 + CS1_85_TYPLR1_VOIT0 + CS1_86_TYPLR1_VOIT0 +
CS1_87_TYPLR1_VOIT0 + CS1_88_TYPLR1_VOIT0 + CS1_81_TYPLR2_VOIT0 + CS1_82_TYPLR2_VOIT0 + CS1_83_TYPLR2_VOIT0 + CS1_84_TYPLR2_VOIT0 + CS1_85_TYPLR2_VOIT0 + CS1_86_TYPLR2_VOIT0 +
CS1_87_TYPLR2_VOIT0 + CS1_88_TYPLR2_VOIT0 + CS1_81_TYPLR3_VOIT0 + CS1_82_TYPLR3_VOIT0 + CS1_83_TYPLR3_VOIT0 + CS1_84_TYPLR3_VOIT0 + CS1_85_TYPLR3_VOIT0 + CS1_86_TYPLR3_VOIT0 +
CS1_87_TYPLR3_VOIT0 + CS1_88_TYPLR3_VOIT0 AS A1,

CS1_81_TYPLR1_VOIT1 + CS1_82_TYPLR1_VOIT1 + CS1_83_TYPLR1_VOIT1 + CS1_84_TYPLR1_VOIT1 + CS1_85_TYPLR1_VOIT1 + CS1_86_TYPLR1_VOIT1 +
CS1_87_TYPLR1_VOIT1 + CS1_88_TYPLR1_VOIT1 + CS1_81_TYPLR2_VOIT1 + CS1_82_TYPLR2_VOIT1 + CS1_83_TYPLR2_VOIT1 + CS1_84_TYPLR2_VOIT1 + CS1_85_TYPLR2_VOIT1 + CS1_86_TYPLR2_VOIT1 +  CS1_87_TYPLR2_VOIT1 + CS1_88_TYPLR2_VOIT1 + CS1_81_TYPLR3_VOIT1 + CS1_82_TYPLR3_VOIT1 + CS1_83_TYPLR3_VOIT1 + CS1_84_TYPLR3_VOIT1 + CS1_85_TYPLR3_VOIT1 + CS1_86_TYPLR3_VOIT1 +
CS1_87_TYPLR3_VOIT1 + CS1_88_TYPLR3_VOIT1 AS A2,

CS1_81_TYPLR1_VOIT2 + CS1_82_TYPLR1_VOIT2 + CS1_83_TYPLR1_VOIT2 + CS1_84_TYPLR1_VOIT2 + CS1_85_TYPLR1_VOIT2 + CS1_86_TYPLR1_VOIT2 +
CS1_87_TYPLR1_VOIT2 + CS1_88_TYPLR1_VOIT2 + CS1_81_TYPLR2_VOIT2 + CS1_82_TYPLR2_VOIT2 + CS1_83_TYPLR2_VOIT2 + CS1_84_TYPLR2_VOIT2 + CS1_85_TYPLR2_VOIT2 + CS1_86_TYPLR2_VOIT2 +
CS1_87_TYPLR2_VOIT2 + CS1_88_TYPLR2_VOIT2 + CS1_81_TYPLR3_VOIT2 + CS1_82_TYPLR3_VOIT2 + CS1_83_TYPLR3_VOIT2 + CS1_84_TYPLR3_VOIT2 + CS1_85_TYPLR3_VOIT2 + CS1_86_TYPLR3_VOIT2 +
CS1_87_TYPLR3_VOIT2 + CS1_88_TYPLR3_VOIT2 AS A3,

CS1_81_TYPLR1_VOIT3 + CS1_82_TYPLR1_VOIT3 + CS1_83_TYPLR1_VOIT3 + CS1_84_TYPLR1_VOIT3 + CS1_85_TYPLR1_VOIT3 + CS1_86_TYPLR1_VOIT3 + CS1_87_TYPLR1_VOIT3 + CS1_88_TYPLR1_VOIT3 + CS1_81_TYPLR2_VOIT3 + CS1_82_TYPLR2_VOIT3 + CS1_83_TYPLR2_VOIT3 + CS1_84_TYPLR2_VOIT3 + CS1_85_TYPLR2_VOIT3 + CS1_86_TYPLR2_VOIT3 +
CS1_87_TYPLR2_VOIT3 + CS1_88_TYPLR2_VOIT3 + CS1_81_TYPLR3_VOIT3 + CS1_82_TYPLR3_VOIT3 + CS1_83_TYPLR3_VOIT3 + CS1_84_TYPLR3_VOIT3 + CS1_85_TYPLR3_VOIT3 + CS1_86_TYPLR3_VOIT3 +
CS1_87_TYPLR3_VOIT3 + CS1_88_TYPLR3_VOIT3 AS A4,

CS1_81_TYPLR1_VOIT0+ CS1_81_TYPLR1_VOIT1+ CS1_81_TYPLR1_VOIT2+CS1_81_TYPLR1_VOIT3+ CS1_82_TYPLR1_VOIT0+ CS1_82_TYPLR1_VOIT1+ CS1_82_TYPLR1_VOIT2+ CS1_82_TYPLR1_VOIT3+
CS1_83_TYPLR1_VOIT0+ CS1_83_TYPLR1_VOIT1+ CS1_83_TYPLR1_VOIT2+ CS1_83_TYPLR1_VOIT3+ CS1_84_TYPLR1_VOIT0+ CS1_84_TYPLR1_VOIT1+ CS1_84_TYPLR1_VOIT2+ CS1_84_TYPLR1_VOIT3+ CS1_85_TYPLR1_VOIT0+ CS1_85_TYPLR1_VOIT1+
CS1_85_TYPLR1_VOIT2+ CS1_85_TYPLR1_VOIT3+ CS1_86_TYPLR1_VOIT0+ CS1_86_TYPLR1_VOIT1+ CS1_86_TYPLR1_VOIT2+ CS1_86_TYPLR1_VOIT3+ CS1_87_TYPLR1_VOIT0+CS1_87_TYPLR1_VOIT1+ CS1_87_TYPLR1_VOIT2+ CS1_87_TYPLR1_VOIT3+ CS1_88_TYPLR1_VOIT0+
CS1_88_TYPLR1_VOIT1+ CS1_88_TYPLR1_VOIT2+ CS1_88_TYPLR1_VOIT3+ CS1_81_TYPLR2_VOIT0+ CS1_81_TYPLR2_VOIT1+ CS1_81_TYPLR2_VOIT2+ CS1_81_TYPLR2_VOIT3+ CS1_82_TYPLR2_VOIT0+ CS1_82_TYPLR2_VOIT1+ CS1_82_TYPLR2_VOIT2+ CS1_82_TYPLR2_VOIT3+
CS1_83_TYPLR2_VOIT0+CS1_83_TYPLR2_VOIT1+ CS1_83_TYPLR2_VOIT2+ CS1_83_TYPLR2_VOIT3+ CS1_84_TYPLR2_VOIT0+ CS1_84_TYPLR2_VOIT1+ CS1_84_TYPLR2_VOIT2+ CS1_84_TYPLR2_VOIT3+ CS1_85_TYPLR2_VOIT0+ CS1_85_TYPLR2_VOIT1+ CS1_85_TYPLR2_VOIT2+ CS1_85_TYPLR2_VOIT3+
CS1_86_TYPLR2_VOIT0+ CS1_86_TYPLR2_VOIT1+ CS1_86_TYPLR2_VOIT2+ CS1_86_TYPLR2_VOIT3+ CS1_87_TYPLR2_VOIT0+ CS1_87_TYPLR2_VOIT1+ CS1_87_TYPLR2_VOIT2+ CS1_87_TYPLR2_VOIT3+ CS1_88_TYPLR2_VOIT0+ CS1_88_TYPLR2_VOIT1+ CS1_88_TYPLR2_VOIT2+ CS1_88_TYPLR2_VOIT3+
CS1_81_TYPLR3_VOIT0+ CS1_81_TYPLR3_VOIT1+ CS1_81_TYPLR3_VOIT2+ CS1_81_TYPLR3_VOIT3+ CS1_82_TYPLR3_VOIT0+ CS1_82_TYPLR3_VOIT1+ CS1_82_TYPLR3_VOIT2+ CS1_82_TYPLR3_VOIT3+ CS1_83_TYPLR3_VOIT0+ CS1_83_TYPLR3_VOIT1+ CS1_83_TYPLR3_VOIT2+ CS1_83_TYPLR3_VOIT3+
CS1_84_TYPLR3_VOIT0+ CS1_84_TYPLR3_VOIT1+ CS1_84_TYPLR3_VOIT2+ CS1_84_TYPLR3_VOIT3+ CS1_85_TYPLR3_VOIT0+ CS1_85_TYPLR3_VOIT1+ CS1_85_TYPLR3_VOIT2+ CS1_85_TYPLR3_VOIT3+
CS1_86_TYPLR3_VOIT0+ CS1_86_TYPLR3_VOIT1+ CS1_86_TYPLR3_VOIT2+CS1_86_TYPLR3_VOIT3+ CS1_87_TYPLR3_VOIT0+ CS1_87_TYPLR3_VOIT1+ CS1_87_TYPLR3_VOIT2+ CS1_87_TYPLR3_VOIT3+ CS1_88_TYPLR3_VOIT0+ CS1_88_TYPLR3_VOIT1+ CS1_88_TYPLR3_VOIT2+ CS1_88_TYPLR3_VOIT3 AS A5,

CS1_81_TYPLR1_VOIT0+CS1_82_TYPLR1_VOIT0+CS1_83_TYPLR1_VOIT0+CS1_85_TYPLR1_VOIT0+CS1_86_TYPLR1_VOIT0+CS1_87_TYPLR1_VOIT0+CS1_88_TYPLR1_VOIT0  AS A6,

CS1_81_TYPLR1_VOIT1+CS1_82_TYPLR1_VOIT1+CS1_83_TYPLR1_VOIT1+CS1_85_TYPLR1_VOIT1+CS1_86_TYPLR1_VOIT1+CS1_87_TYPLR1_VOIT1+CS1_88_TYPLR1_VOIT1  AS A7,

CS1_81_TYPLR1_VOIT2+CS1_82_TYPLR1_VOIT2+CS1_83_TYPLR1_VOIT2+CS1_85_TYPLR1_VOIT2+CS1_86_TYPLR1_VOIT2 +CS1_87_TYPLR1_VOIT2+CS1_88_TYPLR1_VOIT2  AS A8,

CS1_81_TYPLR1_VOIT3+CS1_82_TYPLR1_VOIT3+CS1_83_TYPLR1_VOIT3+CS1_85_TYPLR1_VOIT3+CS1_86_TYPLR1_VOIT3+CS1_87_TYPLR1_VOIT3+CS1_88_TYPLR1_VOIT3  AS A9,

CS1_81_TYPLR1_VOIT0+CS1_82_TYPLR1_VOIT0+CS1_83_TYPLR1_VOIT0+CS1_85_TYPLR1_VOIT0+CS1_86_TYPLR1_VOIT0+CS1_87_TYPLR1_VOIT0+CS1_88_TYPLR1_VOIT0+
CS1_81_TYPLR1_VOIT1+CS1_82_TYPLR1_VOIT1+CS1_83_TYPLR1_VOIT1+CS1_85_TYPLR1_VOIT1+CS1_86_TYPLR1_VOIT1+CS1_87_TYPLR1_VOIT1+CS1_88_TYPLR1_VOIT1+
CS1_81_TYPLR1_VOIT2+CS1_82_TYPLR1_VOIT2+CS1_83_TYPLR1_VOIT2+CS1_85_TYPLR1_VOIT2+CS1_86_TYPLR1_VOIT2+CS1_87_TYPLR1_VOIT2+CS1_88_TYPLR1_VOIT2+
CS1_81_TYPLR1_VOIT3+CS1_82_TYPLR1_VOIT3+CS1_83_TYPLR1_VOIT3+CS1_85_TYPLR1_VOIT3+CS1_86_TYPLR1_VOIT3+CS1_87_TYPLR1_VOIT3+CS1_88_TYPLR1_VOIT3  AS A10,

CS1_81_TYPLR2_VOIT0+CS1_82_TYPLR2_VOIT0+CS1_83_TYPLR2_VOIT0+CS1_85_TYPLR2_VOIT0 +CS1_86_TYPLR2_VOIT0+CS1_87_TYPLR2_VOIT0+CS1_88_TYPLR2_VOIT0  AS A11,

CS1_81_TYPLR2_VOIT1+CS1_82_TYPLR2_VOIT1+CS1_83_TYPLR2_VOIT1+CS1_85_TYPLR2_VOIT1+CS1_86_TYPLR2_VOIT1+CS1_87_TYPLR2_VOIT1+CS1_88_TYPLR2_VOIT1  AS A12,

CS1_81_TYPLR2_VOIT2+CS1_82_TYPLR2_VOIT2+CS1_83_TYPLR2_VOIT2+CS1_85_TYPLR2_VOIT2+CS1_86_TYPLR2_VOIT2+CS1_87_TYPLR2_VOIT2+CS1_88_TYPLR2_VOIT2  AS A13,

CS1_81_TYPLR2_VOIT3+CS1_82_TYPLR2_VOIT3+CS1_83_TYPLR2_VOIT3+CS1_85_TYPLR2_VOIT3+CS1_86_TYPLR2_VOIT3+CS1_87_TYPLR2_VOIT3+CS1_88_TYPLR2_VOIT3  AS A14,

CS1_81_TYPLR2_VOIT0+CS1_82_TYPLR2_VOIT0+CS1_83_TYPLR2_VOIT0+CS1_85_TYPLR2_VOIT0+CS1_86_TYPLR2_VOIT0+CS1_87_TYPLR2_VOIT0+CS1_88_TYPLR2_VOIT0+
CS1_81_TYPLR2_VOIT1+CS1_82_TYPLR2_VOIT1+CS1_83_TYPLR2_VOIT1+CS1_85_TYPLR2_VOIT1+CS1_86_TYPLR2_VOIT1+CS1_87_TYPLR2_VOIT1+CS1_88_TYPLR2_VOIT1+
CS1_81_TYPLR2_VOIT2+CS1_82_TYPLR2_VOIT2+CS1_83_TYPLR2_VOIT2+CS1_85_TYPLR2_VOIT2+CS1_86_TYPLR2_VOIT2+CS1_87_TYPLR2_VOIT2+CS1_88_TYPLR2_VOIT2+
CS1_81_TYPLR2_VOIT3+CS1_82_TYPLR2_VOIT3+CS1_83_TYPLR2_VOIT3+CS1_85_TYPLR2_VOIT3+CS1_86_TYPLR2_VOIT3+CS1_87_TYPLR2_VOIT3+CS1_88_TYPLR2_VOIT3  AS A15,

CS1_81_TYPLR3_VOIT0+CS1_82_TYPLR3_VOIT0+CS1_83_TYPLR3_VOIT0+CS1_85_TYPLR3_VOIT0+CS1_86_TYPLR3_VOIT0+CS1_87_TYPLR3_VOIT0+CS1_88_TYPLR3_VOIT0 AS A16,

CS1_81_TYPLR3_VOIT1+CS1_82_TYPLR3_VOIT1+CS1_83_TYPLR3_VOIT1+CS1_85_TYPLR3_VOIT1+CS1_86_TYPLR3_VOIT1+CS1_87_TYPLR3_VOIT1+CS1_88_TYPLR3_VOIT1  AS A17,

CS1_81_TYPLR3_VOIT2+CS1_82_TYPLR3_VOIT2+CS1_83_TYPLR3_VOIT2+CS1_85_TYPLR3_VOIT2+CS1_86_TYPLR3_VOIT2+CS1_87_TYPLR3_VOIT2+CS1_88_TYPLR3_VOIT2  AS A18,

CS1_81_TYPLR3_VOIT3+CS1_82_TYPLR3_VOIT3+CS1_83_TYPLR3_VOIT3+CS1_85_TYPLR3_VOIT3+CS1_86_TYPLR3_VOIT3+CS1_87_TYPLR3_VOIT3+CS1_88_TYPLR3_VOIT3  AS A19,

CS1_81_TYPLR3_VOIT0+CS1_82_TYPLR3_VOIT0+CS1_83_TYPLR3_VOIT0+CS1_85_TYPLR3_VOIT0+CS1_86_TYPLR3_VOIT0+CS1_87_TYPLR3_VOIT0+CS1_88_TYPLR3_VOIT0+CS1_81_TYPLR3_VOIT1+
CS1_82_TYPLR3_VOIT1+CS1_83_TYPLR3_VOIT1+CS1_85_TYPLR3_VOIT1+CS1_86_TYPLR3_VOIT1+CS1_87_TYPLR3_VOIT1+CS1_88_TYPLR3_VOIT1+CS1_81_TYPLR3_VOIT2+CS1_82_TYPLR3_VOIT2+
CS1_83_TYPLR3_VOIT2+CS1_85_TYPLR3_VOIT2+CS1_86_TYPLR3_VOIT2+CS1_87_TYPLR3_VOIT2+CS1_88_TYPLR3_VOIT2+CS1_81_TYPLR3_VOIT3+CS1_82_TYPLR3_VOIT3+CS1_83_TYPLR3_VOIT3+
CS1_85_TYPLR3_VOIT3+CS1_86_TYPLR3_VOIT3+CS1_87_TYPLR3_VOIT3+CS1_88_TYPLR3_VOIT3  AS A20,

libgeo

FROM $table";


$result=pg_query($dbconn , $requetePRINC18);
$tableauPRINC18=array();
while ($ligne = pg_fetch_row($result)) {
  $tableauPRINC18[]= $ligne;
}

echo json_encode($tableauPRINC18,JSON_NUMERIC_CHECK);

}

} else {

}
?>
