<?php
include('connect_PRINC8.php');

$echelle = $_POST["echelle"];
$annee = $_POST["annee"];

if($echelle == "Communes"){

$table="btx_td_princ8_".$annee;

if(isset($_POST["requete"])){

  $requetePRINC8 = "SELECT codgeo, libgeo,

  GARL1_NBPIR1_TYPLR1 + GARL1_NBPIR1_TYPLR2 +GARL1_NBPIR1_TYPLR3 + GARL1_NBPIR2_TYPLR1 + GARL1_NBPIR2_TYPLR2 +GARL1_NBPIR2_TYPLR3 +GARL1_NBPIR3_TYPLR1 + GARL1_NBPIR3_TYPLR2 +GARL1_NBPIR3_TYPLR3 +GARL1_NBPIR4_TYPLR1 +
  GARL1_NBPIR4_TYPLR2 +GARL1_NBPIR4_TYPLR3 + GARL1_NBPIR5_TYPLR1 + GARL1_NBPIR5_TYPLR2 +GARL1_NBPIR5_TYPLR3 +GARL1_NBPIR6_TYPLR1 + GARL1_NBPIR6_TYPLR2 +GARL1_NBPIR6_TYPLR3 AS B2,

  GARL2_NBPIR1_TYPLR1 + GARL2_NBPIR1_TYPLR2 +GARL2_NBPIR1_TYPLR3 + GARL2_NBPIR2_TYPLR1 + GARL2_NBPIR2_TYPLR2 +GARL2_NBPIR2_TYPLR3 +GARL2_NBPIR3_TYPLR1 + GARL2_NBPIR3_TYPLR2 +GARL2_NBPIR3_TYPLR3 +GARL2_NBPIR4_TYPLR1 +
  GARL2_NBPIR4_TYPLR2 +GARL2_NBPIR4_TYPLR3 + GARL2_NBPIR5_TYPLR1 + GARL2_NBPIR5_TYPLR2 +GARL2_NBPIR5_TYPLR3 +GARL2_NBPIR6_TYPLR1 + GARL2_NBPIR6_TYPLR2 +GARL2_NBPIR6_TYPLR3 AS B3,

  GARL1_NBPIR1_TYPLR1 + GARL1_NBPIR1_TYPLR2 +GARL1_NBPIR1_TYPLR3 + GARL1_NBPIR2_TYPLR1 + GARL1_NBPIR2_TYPLR2 +GARL1_NBPIR2_TYPLR3 +GARL1_NBPIR3_TYPLR1 + GARL1_NBPIR3_TYPLR2 +GARL1_NBPIR3_TYPLR3 +GARL1_NBPIR4_TYPLR1 +
  GARL1_NBPIR4_TYPLR2 +GARL1_NBPIR4_TYPLR3 + GARL1_NBPIR5_TYPLR1 + GARL1_NBPIR5_TYPLR2 +GARL1_NBPIR5_TYPLR3 +GARL1_NBPIR6_TYPLR1 + GARL1_NBPIR6_TYPLR2 +GARL1_NBPIR6_TYPLR3 +  GARL2_NBPIR1_TYPLR1 + GARL2_NBPIR1_TYPLR2 +
  GARL2_NBPIR1_TYPLR3 + GARL2_NBPIR2_TYPLR1 + GARL2_NBPIR2_TYPLR2 +GARL2_NBPIR2_TYPLR3 +GARL2_NBPIR3_TYPLR1 + GARL2_NBPIR3_TYPLR2 +GARL2_NBPIR3_TYPLR3 +GARL2_NBPIR4_TYPLR1 + GARL2_NBPIR4_TYPLR2 +GARL2_NBPIR4_TYPLR3 +
  GARL2_NBPIR5_TYPLR1 + GARL2_NBPIR5_TYPLR2 +GARL2_NBPIR5_TYPLR3 +GARL2_NBPIR6_TYPLR1 + GARL2_NBPIR6_TYPLR2 +GARL2_NBPIR6_TYPLR3 AS B4,

  GARL1_NBPIR1_TYPLR1 + GARL1_NBPIR2_TYPLR1 + GARL1_NBPIR3_TYPLR1 + GARL1_NBPIR4_TYPLR1 + GARL1_NBPIR5_TYPLR1 +GARL1_NBPIR6_TYPLR1 AS B5,

  GARL2_NBPIR1_TYPLR1 + GARL2_NBPIR2_TYPLR1 + GARL2_NBPIR3_TYPLR1 + GARL2_NBPIR4_TYPLR1 + GARL2_NBPIR5_TYPLR1 +GARL2_NBPIR6_TYPLR1 AS B6,

  GARL1_NBPIR1_TYPLR1 + GARL1_NBPIR2_TYPLR1 + GARL1_NBPIR3_TYPLR1 + GARL1_NBPIR4_TYPLR1 + GARL1_NBPIR5_TYPLR1 +GARL1_NBPIR6_TYPLR1 +GARL2_NBPIR1_TYPLR1 + GARL2_NBPIR2_TYPLR1 + GARL2_NBPIR3_TYPLR1 + GARL2_NBPIR4_TYPLR1 + GARL2_NBPIR5_TYPLR1 +GARL2_NBPIR6_TYPLR1 AS B7,

  GARL1_NBPIR1_TYPLR2 + GARL1_NBPIR2_TYPLR2 + GARL1_NBPIR3_TYPLR2 + GARL1_NBPIR4_TYPLR2 + GARL1_NBPIR5_TYPLR2 +GARL1_NBPIR6_TYPLR2 AS B8,

  GARL2_NBPIR1_TYPLR2 + GARL2_NBPIR2_TYPLR2 + GARL2_NBPIR3_TYPLR2 + GARL2_NBPIR4_TYPLR2 + GARL2_NBPIR5_TYPLR2 +GARL2_NBPIR6_TYPLR2 AS B9,

  GARL1_NBPIR1_TYPLR2 + GARL1_NBPIR2_TYPLR2 + GARL1_NBPIR3_TYPLR2 + GARL1_NBPIR4_TYPLR2 + GARL1_NBPIR5_TYPLR2 +GARL1_NBPIR6_TYPLR2 + GARL2_NBPIR1_TYPLR2 + GARL2_NBPIR2_TYPLR2 + GARL2_NBPIR3_TYPLR2 + GARL2_NBPIR4_TYPLR2 + GARL2_NBPIR5_TYPLR2 +GARL2_NBPIR6_TYPLR2 AS B10,

  GARL1_NBPIR1_TYPLR3 + GARL1_NBPIR2_TYPLR3 + GARL1_NBPIR3_TYPLR3 + GARL1_NBPIR4_TYPLR3 + GARL1_NBPIR5_TYPLR3 +GARL1_NBPIR6_TYPLR3 AS B11,

  GARL2_NBPIR1_TYPLR3 + GARL2_NBPIR2_TYPLR3 + GARL2_NBPIR3_TYPLR3 + GARL2_NBPIR4_TYPLR3 + GARL2_NBPIR5_TYPLR3 +GARL2_NBPIR6_TYPLR3 AS B12,

  GARL1_NBPIR1_TYPLR3 + GARL1_NBPIR2_TYPLR3 + GARL1_NBPIR3_TYPLR3 + GARL1_NBPIR4_TYPLR3 + GARL1_NBPIR5_TYPLR3 +GARL1_NBPIR6_TYPLR3 + GARL2_NBPIR1_TYPLR3 + GARL2_NBPIR2_TYPLR3 + GARL2_NBPIR3_TYPLR3 + GARL2_NBPIR4_TYPLR3 + GARL2_NBPIR5_TYPLR3 +GARL2_NBPIR6_TYPLR3 AS B13

  FROM $table";


$result=pg_query($dbconn , $requetePRINC8);
$tableauPRINC8=array();
while ($ligne = pg_fetch_row($result)) {
  $tableauPRINC8[]= $ligne;
}

echo json_encode($tableauPRINC8,JSON_NUMERIC_CHECK);

}

} else {

}
?>
